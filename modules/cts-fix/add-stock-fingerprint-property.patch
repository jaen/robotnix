diff --git a/core/main.mk b/core/main.mk
index ae0b86c6ce..ed785a1e81 100644
--- a/core/main.mk
+++ b/core/main.mk
@@ -493,6 +493,15 @@ endif
 # Typical build; include any Android.mk files we can find.
 #
 
+# Use the PRODUCT_OVERRIDE_FINGERPRINT variable emitted by adevtool to set fingerprint value for spoofing
+ifneq ($(PRODUCT_OVERRIDE_FINGERPRINT),)
+  $(call pretty-warning, ro.build.stock_fingerprint will be set to: $(PRODUCT_OVERRIDE_FINGERPRINT))
+
+  ADDITIONAL_SYSTEM_PROPERTIES += ro.build.stock_fingerprint=$(PRODUCT_OVERRIDE_FINGERPRINT)
+else
+  $(error CTS fix enabled, but PRODUCT_OVERRIDE_FINGERPRINT is not set)
+endif
+
 # Bring in dex_preopt.mk
 # This creates some modules so it needs to be included after
 # should-install-to-system is defined (in order for base_rules.mk to function
